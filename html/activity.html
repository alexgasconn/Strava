<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Strava Activity Details</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../styles/style.css">

  <!-- External Libraries -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
  <div class="container">
    <h1>Activity Details</h1>

    <!-- ======================================
         SECTION 1: OVERVIEW & QUICK STATS
         ====================================== -->
    <div id="activity-details-row" class="activity-details-row">
      <div id="activity-info" class="activity-details-col"></div>
      <div id="activity-stats" class="activity-details-col"></div>
      <div id="activity-advanced" class="activity-details-col"></div>
    </div>

    <!-- ======================================
         SECTION 2: ANALYSIS & ZONES
         ====================================== -->
    <div class="side-by-side-container">
      <div id="run-classifier-section" class="data-section">
        <h3>Run Type Analysis</h3>
        <div id="run-classifier-results">
          <p>Analyzing run data...</p>
        </div>
      </div>

      <div id="hr-zones-section" class="data-section">
        <h3>Time in Heart Rate Zones</h3>
        <div class="chart-container-inner">
          <canvas id="hr-zones-chart"></canvas>
        </div>
      </div>
    </div>

    <!-- ======================================
         SECTION 3: ROUTE MAP
         ====================================== -->
    <div id="activity-map-container" class="data-section">
      <h3>Route Map</h3>
      <div id="activity-map"></div>
    </div>

    <!-- ======================================
         SECTION 4: KM SPLITS
         ====================================== -->
    <div id="splits-section" class="data-section hidden">
      <h3>ğŸ“ˆ Splits per Kilometer</h3>
      <div class="side-by-side-container">
        <div class="chart-container">
          <canvas id="chart-pace"></canvas>
        </div>
        <div class="chart-container">
          <canvas id="chart-heartrate"></canvas>
        </div>
      </div>
    </div>

    <!-- ======================================
         SECTION 4B: SMOOTHING CONTROL
         ====================================== -->
    <div class="data-section" style="margin: 20px 0; padding: 15px; background-color: #f5f5f5; border-radius: 8px;">
      <h3>Stream Smoothing Control</h3>
      <p style="margin: 0 0 15px 0; font-size: 0.9em; color: #666;">Adjust the smoothing level to reduce noise in stream charts</p>
      <div style="display: flex; align-items: center; gap: 15px;">
        <label for="smoothing-slider" style="font-weight: bold; min-width: 100px;">Smoothing Level:</label>
        <input 
          type="range" 
          id="smoothing-slider" 
          min="0" 
          max="200" 
          value="100" 
          step="10"
          style="flex: 1; cursor: pointer; height: 6px;"
        />
        <span id="smoothing-value" style="min-width: 50px; text-align: right; font-weight: bold; color: #FC5200;">100</span>
      </div>
      <div style="margin-top: 8px; font-size: 0.85em; color: #888;">
        <span style="display: inline-block; margin-right: 20px;">ğŸ”µ 0 = No smoothing (raw data)</span>
        <span style="display: inline-block; margin-right: 20px;">ğŸŸ¢ 100 = Default smoothing</span>
        <span>ğŸ”´ 200 = Maximum smoothing</span>
      </div>
    </div>

    <!-- ======================================
         SECTION 5: DETAILED STREAM DATA
         ====================================== -->
    <div id="stream-charts" class="charts-grid">
      <div class="chart-container">
        <canvas id="chart-altitude"></canvas>
      </div>
      <div class="chart-container">
        <canvas id="chart-pace-distance"></canvas>
      </div>
      <div class="chart-container">
        <canvas id="chart-heart-distance"></canvas>
      </div>
      <div class="chart-container">
        <canvas id="chart-cadence-distance"></canvas>
      </div>
    </div>

    <!-- ======================================
         SECTION 6: MIN/MAX AREA CHARTS
         ====================================== -->
    <div class="side-by-side-container">
      <div id="hr-min-max-area-section" class="data-section hidden">
        <h3>â¤ï¸ Heart Rate Variability</h3>
        <p>Min/Max/Avg heart rate across the route</p>
        <div class="chart-container">
          <canvas id="hr-minmax-area-chart"></canvas>
        </div>
      </div>

      <div id="pace-min-max-area-section" class="data-section hidden">
        <h3>âš¡ Pace Variability</h3>
        <p>Min/Max/Avg pace across the route</p>
        <div class="chart-container">
          <canvas id="pace-min-max-area-chart"></canvas>
        </div>
      </div>
    </div>

    <!-- ======================================
         SECTION 7: LAPS DATA
         ====================================== -->
    <div class="side-by-side-container">
      <div id="laps-section" class="data-section hidden">
        <h3>ğŸ”„ Laps</h3>
        <p>Details for each lap (auto-laps or manual)</p>
        <div class="table-container">
          <table id="laps-table" class="df-table"></table>
        </div>
      </div>

      <div id="laps-chart-section" class="data-section hidden">
        <h3>ğŸ“Š Lap Pace Comparison</h3>
        <div class="chart-container">
          <canvas id="laps-chart"></canvas>
        </div>
      </div>
    </div>

    <!-- ======================================
         SECTION 8: ACHIEVEMENTS & SEGMENTS
         ====================================== -->
    <div class="side-by-side-container">
      <div id="best-efforts-section" class="data-section hidden">
        <h3>ğŸ† Best Efforts</h3>
        <p>Personal records for standard distances during this activity</p>
        <div class="table-container">
          <table id="best-efforts-table" class="df-table"></table>
        </div>
      </div>

      <div id="segments-section" class="data-section hidden">
        <h3>â›°ï¸ Segment Efforts</h3>
        <p>Performance on Strava segments</p>
        <div class="table-container">
          <table id="segments-table" class="df-table"></table>
        </div>
      </div>
    </div>

    <!-- Close Button -->
    <button onclick="window.close()">Close</button>
  </div>

  <!-- Scripts -->
  <script src="../classifyRun.js"></script>
  <script src="../js/activity.js"></script>

</body>

</html>